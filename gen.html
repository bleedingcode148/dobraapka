<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mObywatel v5.0 | #bleedingcode</title>
    <style>
        /* Nowoczesne czcionki */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');

        :root {
            --bg-gradient-start: #0f0f23;
            --bg-gradient-mid: #1a1a3e;
            --bg-gradient-end: #16213e;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: #e2e8f0;
            --text-muted: #94a3b8;
            --accent-primary: #0ea5e9;
            --accent-secondary: #06b6d4;
            --accent-glow: rgba(14, 165, 233, 0.4);
            --success: #22c55e;
            --error: #f43f5e;
            --warning: #fbbf24;
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-mid) 50%, var(--bg-gradient-end) 100%);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(14, 165, 233, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(6, 182, 212, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(34, 197, 94, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(251, 191, 36, 0.1) 0%, transparent 40%);
            z-index: 0;
            animation: floatingGradient 20s ease-in-out infinite;
        }

        /* Particles container */
        #particles-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .container {
            background: var(--glass-bg);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            position: relative;
            z-index: 10;
            
            padding: 40px;
            border-radius: 32px;
            border: 1px solid var(--glass-border);
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 0 20px rgba(124, 58, 237, 0.1);
            width: 100%;
            max-width: 420px;
            margin-bottom: 20px;
            animation: containerEntrance 1s cubic-bezier(0.4, 0, 0.2, 1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 35px 60px -12px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 0 30px rgba(14, 165, 233, 0.12);
        }

        h1 {
            font-family: 'Space Grotesk', sans-serif;
            color: var(--text-primary);
            text-align: center;
            margin-bottom: 35px;
            font-weight: 700;
            letter-spacing: 2px;
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            border-bottom: 2px solid var(--glass-border);
            padding-bottom: 20px;
            animation: titleGlow 3s ease-in-out infinite alternate;
            position: relative;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-secondary), transparent);
            animation: slideUnderline 3s ease-in-out infinite;
        }
        
        .form-group {
            margin-bottom: 24px;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: formGroupEntrance 0.8s ease-out;
            animation-fill-mode: both;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9rem;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
        }

        /* Enhanced focus effects */
        .form-group:focus-within {
            transform: translateY(-3px) scale(1.02);
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(6, 182, 212, 0.05));
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(14, 165, 233, 0.2);
        }
        
        .form-group:focus-within label {
            color: var(--accent-primary);
            text-shadow: 0 0 15px rgba(14, 165, 233, 0.5);
            transform: translateX(5px);
        }

        input[type="text"], input[type="date"], select {
            width: 100%;
            padding: 18px 16px;
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.02);
            color: var(--text-primary);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
            font-weight: 500;
            -webkit-appearance: none;
            appearance: none;
            position: relative;
        }
        
        input[type="text"]:focus, input[type="date"]:focus, select:focus {
            border-color: var(--accent-primary);
            outline: none;
            box-shadow: 
                0 0 0 4px rgba(14, 165, 233, 0.2),
                0 0 20px rgba(14, 165, 233, 0.3);
            background: rgba(255, 255, 255, 0.05);
            transform: scale(1.02);
        }
        
        ::placeholder {
            color: var(--text-muted);
            opacity: 0.7;
            font-style: italic;
        }
        
        /* Dostosowanie pola daty dla lepszej widoczno≈õci w ciemnym motywie */
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1); /* Odwraca kolor ikonki kalendarza na bia≈Çy */
            cursor: pointer;
        }
        
        /* Enhanced autofill block */
        .autofill-block {
            margin: 20px 0;
            padding: 20px;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(6, 182, 212, 0.05));
            border: 1px solid rgba(14, 165, 233, 0.3);
            box-shadow: 
                0 10px 30px rgba(14, 165, 233, 0.15),
                inset 0 0 20px rgba(14, 165, 233, 0.05);
            position: relative;
            overflow: hidden;
        }

        .autofill-block::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.8s ease;
        }

        .autofill-block:hover::before {
            left: 100%;
        }

        #autofillButton {
            width: 100%;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin: 0;
            position: relative;
            overflow: hidden;
            
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-primary);
            box-shadow: 
                0 4px 15px rgba(124, 58, 237, 0.4),
                0 0 20px rgba(124, 58, 237, 0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #autofillButton::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        #autofillButton:hover:not([disabled]) {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 8px 25px rgba(14, 165, 233, 0.6),
                0 0 30px rgba(14, 165, 233, 0.3);
        }

        #autofillButton:hover:not([disabled])::before {
            left: 100%;
        }

        #autofillButton:active {
            transform: translateY(-1px) scale(1.02);
        }
        
        #statusMessageAutofill {
            text-align: center;
            margin-top: 15px;
            min-height: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.02);
        }
        /* --- KONIEC STYLU DLA BLOKU AUTOFILL --- */


        /* Enhanced main generate button */
        #generateButton {
            width: 100%;
            padding: 20px 24px;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 800;
            transition: all 0.3s ease;
            margin-top: 35px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            animation: generateButtonEntrance 1s ease-out 0.6s;
            animation-fill-mode: both;
            
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-primary);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            box-shadow: 
                0 10px 30px rgba(14, 165, 233, 0.4),
                0 0 40px rgba(14, 165, 233, 0.2),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-family: 'Space Grotesk', sans-serif;
        }

        #generateButton:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 40px rgba(14, 165, 233, 0.6),
                0 0 60px rgba(14, 165, 233, 0.3),
                inset 0 0 30px rgba(255, 255, 255, 0.15);
        }

        #generateButton:active {
            transform: translateY(-1px);
        }

        button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
            filter: grayscale(0.5);
        }
        
        .divider {
            border: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--glass-border), transparent);
            margin: 35px 0;
            position: relative;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: var(--accent-secondary);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--accent-secondary);
        }
        
        .footer-dev {
            text-align: center;
            padding-top: 15px;
            font-size: 0.8rem;
            color: var(--text-muted);
            letter-spacing: 1px;
            position: relative;
            width: 100%;
            margin-top: 20px;
        }
        
        .footer-dev span {
            display: block;
            color: var(--text-primary);
            font-weight: 800;
            font-size: 1.8rem;
            letter-spacing: 3px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 10px;
            animation: footerGlow 4s ease-in-out infinite alternate;
        }

        /* Enhanced status message */
        #statusMessage {
            text-align: center;
            margin-top: -5px;
            margin-bottom: 20px;
            min-height: 22px;
            font-size: 0.9rem;
            font-weight: 600;
            padding: 10px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        /* Enhanced file upload styles */
        .file-upload-wrapper { 
            position: relative; 
            display: block; 
        }
        
        #fileInput { 
            opacity: 0; 
            position: absolute; 
            z-index: -1; 
            width: 0.1px; 
            height: 0.1px; 
            overflow: hidden; 
        }
        
        .custom-file-upload { 
            display: block; 
            width: 100%; 
            padding: 18px 16px; 
            border: 2px solid var(--glass-border); 
            border-radius: 16px; 
            box-sizing: border-box; 
            background: rgba(255, 255, 255, 0.02); 
            color: var(--text-secondary); 
            cursor: pointer; 
            text-align: center; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            font-size: 1rem; 
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .custom-file-upload::before {
            content: 'üì∑';
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            opacity: 0.7;
        }

        .custom-file-upload:hover { 
            border-color: var(--accent-primary); 
            box-shadow: 
                0 0 0 4px rgba(14, 165, 233, 0.2),
                0 0 20px rgba(14, 165, 233, 0.3);
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }
        
        .image-preview-container { 
            width: 100%; 
            height: 0; 
            opacity: 0; 
            border: 2px dashed transparent; 
            border-radius: 16px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            overflow: hidden; 
            margin-top: 0; 
            cursor: pointer; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            background: rgba(255, 255, 255, 0.02);
        }

        .image-preview-container.active { 
            height: 140px; 
            opacity: 1; 
            margin-top: 10px; 
            border: 2px dashed var(--glass-border); 
            box-shadow: inset 0 0 20px rgba(14, 165, 233, 0.1);
        }

        #imagePreview { 
            max-width: 100%; 
            max-height: 100%; 
            object-fit: contain; 
            border-radius: 12px; 
            display: block; 
            transition: transform 0.3s ease;
        }

        .image-preview-container.active:hover { 
            border-color: var(--accent-primary); 
            box-shadow: 
                inset 0 0 30px rgba(14, 165, 233, 0.2),
                0 0 20px rgba(14, 165, 233, 0.3);
        }

        .image-preview-container.active:hover #imagePreview {
            transform: scale(1.05);
        }

        /* Enhanced instruction details */
        .instruction-details {
            margin-bottom: 30px;
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(124, 58, 237, 0.1);
            position: relative;
        }

        .instruction-details::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .instruction-details:hover::before {
            opacity: 1;
        }

        .instruction-details summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            list-style: none;
            font-family: 'Space Grotesk', sans-serif;
            
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-primary);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
            text-transform: uppercase;
            
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 5px 20px rgba(124, 58, 237, 0.3),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .instruction-details summary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.8s ease;
        }

        .instruction-details summary:hover::before {
            left: 100%;
        }

        .instruction-details summary:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 10px 30px rgba(14, 165, 233, 0.5),
                0 0 30px rgba(14, 165, 233, 0.3),
                inset 0 0 30px rgba(255, 255, 255, 0.15);
        }
        
        .instruction-details[open] summary {
            background: linear-gradient(135deg, var(--accent-secondary), var(--accent-primary));
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            box-shadow: 
                0 5px 15px rgba(14, 165, 233, 0.4),
                inset 0 0 25px rgba(255, 255, 255, 0.15);
        }

        .instruction-details .icon {
            font-size: 1.3rem;
            margin-left: 15px;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-block;
        }

        .instruction-details[open] .icon {
            transform: rotate(90deg) scale(1.2);
        }

        .instruction-content {
            padding: 25px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-top: none;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            color: var(--text-primary);
            animation: contentSlideDown 0.5s ease-out;
        }

        .instruction-content p, .instruction-content strong, .instruction-content li {
            font-size: 0.95rem;
            color: var(--text-primary);
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .instruction-content strong {
            color: var(--accent-secondary);
            font-weight: 600;
            text-shadow: 0 0 10px rgba(14, 165, 233, 0.3);
        }

        .instruction-content ol {
            margin-top: 10px;
            margin-left: 25px;
            padding-left: 0;
        }

        .instruction-content li {
            margin-bottom: 8px;
            position: relative;
            padding-left: 5px;
        }

        .instruction-content li::before {
            content: '‚ñ∏';
            position: absolute;
            left: -20px;
            color: var(--accent-secondary);
            font-weight: bold;
        }

        /* UKRYJ WSZYSTKIE KOMUNIKATY B≈ÅƒòD√ìW HTML5 - AGRESYWNE ROZWIƒÑZANIE */
        input:invalid {
            box-shadow: none !important;
            outline: none !important;
        }
        
        /* Ukryj wszystkie tooltipy b≈Çƒôd√≥w HTML5 */
        input::-webkit-validation-bubble,
        input::-webkit-validation-bubble-arrow,
        input::-webkit-validation-bubble-message,
        input::-webkit-validation-bubble-top-outer-arrow,
        input::-webkit-validation-bubble-top-inner-arrow {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
            position: absolute !important;
            left: -9999px !important;
            width: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
        }
        
        /* Ukryj komunikaty b≈Çƒôd√≥w dla wszystkich przeglƒÖdarek */
        input:invalid::after,
        input:invalid::before {
            display: none !important;
            content: none !important;
        }
        
        /* Ukryj wszystkie elementy zwiƒÖzane z walidacjƒÖ */
        input[data-validate="date"]:invalid {
            border-color: var(--border-clear) !important;
        }
        
        /* Ukryj komunikaty b≈Çƒôd√≥w przez JavaScript - dodaj style inline */
        input[data-validate="date"] {
            -webkit-appearance: none !important;
            appearance: none !important;
        }

        /* Enhanced animations */
        @keyframes floatingGradient {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(-20px, -20px) rotate(90deg);
            }
            50% {
                transform: translate(20px, -10px) rotate(180deg);
            }
            75% {
                transform: translate(-10px, 20px) rotate(270deg);
            }
        }

        @keyframes containerEntrance {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
                filter: blur(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        @keyframes formGroupEntrance {
            from {
                opacity: 0;
                transform: translateX(-30px) translateY(20px);
                filter: blur(5px);
            }
            to {
                opacity: 1;
                transform: translateX(0) translateY(0);
                filter: blur(0);
            }
        }

        @keyframes generateButtonEntrance {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.8);
                filter: blur(8px);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        @keyframes titleGlow {
            from {
                filter: drop-shadow(0 0 20px rgba(14, 165, 233, 0.5));
            }
            to {
                filter: drop-shadow(0 0 30px rgba(14, 165, 233, 0.8)) drop-shadow(0 0 40px rgba(6, 182, 212, 0.4));
            }
        }

        @keyframes slideUnderline {
            0%, 100% {
                transform: translateX(-50%) scaleX(0.5);
                opacity: 0.5;
            }
            50% {
                transform: translateX(-50%) scaleX(1.5);
                opacity: 1;
            }
        }

        @keyframes footerGlow {
            from {
                filter: drop-shadow(0 0 10px rgba(14, 165, 233, 0.3));
            }
            to {
                filter: drop-shadow(0 0 25px rgba(14, 165, 233, 0.6)) drop-shadow(0 0 35px rgba(6, 182, 212, 0.3));
            }
        }

        @keyframes contentSlideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
                max-height: 0;
            }
            to {
                opacity: 1;
                transform: translateY(0);
                max-height: 1000px;
            }
        }

        /* Enhanced delayed animations for form fields */
        .form-group:nth-child(1) { animation-delay: 0.05s; }
        .form-group:nth-child(2) { animation-delay: 0.1s; }
        .form-group:nth-child(3) { animation-delay: 0.15s; }
        .form-group:nth-child(4) { animation-delay: 0.2s; }
        .form-group:nth-child(5) { animation-delay: 0.25s; }
        .form-group:nth-child(6) { animation-delay: 0.3s; }
        .form-group:nth-child(7) { animation-delay: 0.35s; }
        .form-group:nth-child(8) { animation-delay: 0.4s; }
        .form-group:nth-child(9) { animation-delay: 0.45s; }
        .form-group:nth-child(10) { animation-delay: 0.5s; }
        .form-group:nth-child(11) { animation-delay: 0.55s; }
        .form-group:nth-child(12) { animation-delay: 0.6s; }
        .form-group:nth-child(13) { animation-delay: 0.65s; }
        .form-group:nth-child(14) { animation-delay: 0.7s; }
        .form-group:nth-child(15) { animation-delay: 0.75s; }
        .form-group:nth-child(16) { animation-delay: 0.8s; }
        .form-group:nth-child(17) { animation-delay: 0.85s; }
        .form-group:nth-child(18) { animation-delay: 0.9s; }
        .form-group:nth-child(19) { animation-delay: 0.95s; }
        .form-group:nth-child(20) { animation-delay: 1.0s; }

        /* Simple mobile optimization */
        @media (max-width: 768px) {
            .container {
                max-width: 95%;
                padding: 30px 25px;
            }
            
            #generateButton {
                font-size: 1.1rem;
                padding: 18px 20px;
                margin-top: 30px;
                margin-bottom: 25px;
            }
            
            h1 {
                font-size: 2rem;
                margin-bottom: 30px;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
            
            input[type="text"], input[type="date"], select {
                padding: 16px 14px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 25px 20px;
                border-radius: 20px;
            }
            
            #generateButton {
                font-size: 1rem;
                padding: 16px 18px;
                letter-spacing: 1px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }

    </style>
</head>
<body>

    <canvas id="particles-canvas"></canvas>

    <div class="container">
        <h1>mObywatel v5.0</h1>
 <details class="instruction-details">
            <summary>
                INSTRUKCJA 
                <span class="icon">‚ñ∂</span>
            </summary>
            <div class="instruction-content">
                <p>Aby aplikacja dzia≈Ça≈Ça jak skr√≥t na pulpicie telefonu (bez paska adresu przeglƒÖdarki), postƒôpuj zgodnie z krokami.</p>

                <strong style="counter-reset: step-counter;">System iOS (iPhone): üì±</strong>
                <ol>
                    <li>Upewnij siƒô, ≈ºe u≈ºywasz przeglƒÖdarki Safari.</li>
                    <li>Uzupe≈Çnij dane i kliknij GENERUJ.</li>
                    <li>Na nowej stronie naci≈õnij ikonƒô Udostƒôpnij.</li>
                    <li>Wybierz opcjƒô Do Ekranu g≈Ç√≥wnego.</li>
                </ol>

                <strong style="counter-reset: step-counter;">System Android: ü§ñ</strong>
                <ol>
                    <li>Upewnij siƒô, ≈ºe u≈ºywasz przeglƒÖdarki Chrome lub Google.</li>
                    <li>Uzupe≈Çnij dane i kliknij GENERUJ.</li>
                    <li>Na nowej stronie naci≈õnij ikonƒô Menu (3 kropki) w prawym g√≥rnym rogu.</li>
                    <li>Wybierz opcjƒô Dodaj do ekranu g≈Ç√≥wnego.</li>
                </ol>
            </div>
        </details>
        <form id="dataGenerator" novalidate>
            <div class="form-group">
                <label for="name">Imiƒô:</label>
                <input type="text" id="name" name="name" placeholder="Jan" required="">
            </div>

            <div class="form-group">
                <label for="surname">Nazwisko:</label>
                <input type="text" id="surname" name="surname" placeholder="Kowalski" required="">
            </div>

            <div class="form-group">
                <label for="sex">P≈Çeƒá:</label>
                <select id="sex" name="sex" required="">
                    <option value="Mƒò≈ªCZYZNA">Mƒò≈ªCZYZNA</option>
                    <option value="KOBIETA">KOBIETA</option>
                </select>
            </div>

            <div class="form-group">
                <label for="birthday">Data Urodzenia (wybierz z kalendarza):</label>
                <input type="date" id="birthday" name="birthday" required="">
            </div>
            
            <div class="autofill-block">
                <button type="button" id="autofillButton">Wype≈Çnij Daty Automatycznie</button>
                <div id="statusMessageAutofill"></div> 
            </div>
            <div class="form-group">
                <label for="pesel">Numer PESEL:</label>
                <input type="text" id="pesel" name="pesel" placeholder="11-cyfrowy numer" maxlength="11" pattern="[0-9]{11}" required="">
            </div>
            
            <div class="form-group">
                <label for="mdow_series">Seria i numer mDowodu:</label>
                <input type="text" id="mdow_series" name="mdow_series" placeholder="MWYC XXXXX" required="">
            </div>

            <div class="form-group">
                <label for="issue_date">Data wydania mDowodu (DD.MM.RRRR):</label>
                <input 
                    type="text" 
                    id="issue_date" 
                    name="issue_date" 
                    placeholder="14.07.2023" 
                    maxlength="10"
                >
            </div>

            <div class="form-group">
                <label for="expiry_date">Termin wa≈ºno≈õci mDowodu (DD.MM.RRRR):</label>
                <input 
                    type="text" 
                    id="expiry_date" 
                    name="expiry_date" 
                    placeholder="14.07.2028" 
                    maxlength="10"
                >
            </div>

            <div class="form-group">
                <label for="father_name">Imiƒô ojca:</label>
                <input type="text" id="father_name" name="father_name" placeholder="Maciej" required="">
            </div>

            <div class="form-group">
                <label for="mother_name">Imiƒô matki:</label>
                <input type="text" id="mother_name" name="mother_name" placeholder="Ewa" required="">
            </div>

            <div class="form-group">
                <label for="nationality">Obywatelstwo:</label>
                <input type="text" id="nationality" name="nationality" placeholder="POLSKIE" required="">
            </div>
            
            <div class="form-group">
                <label for="birthPlace">Miejsce Urodzenia:</label>
                <input type="text" id="birthPlace" name="birthPlace" placeholder="Warszawa" required="">
            </div>

             <div class="form-group">
                <label for="birth_country">Kraj Urodzenia:</label>
                <input type="text" id="birth_country" name="birth_country" placeholder="Polska" required="">
            </div>
            
            <div class="form-group">
                <label for="adress1">Adres (Ulica i numer):</label>
                <input type="text" id="adress1" name="adress1" placeholder="Chopina 4/56" required="">
            </div>

            <div class="form-group">
                <label for="adress2">Kod pocztowy / nr:</label>
                <input type="text" id="adress2" name="adress2" placeholder="42-250" >
            </div>

            <div class="form-group">
                <label for="city">Miasto:</label>
                <input type="text" id="city" name="city" placeholder="Warszawa" >
            </div>

            <div class="form-group">
                <label for="home_date">Data zameldowania (DD.MM.RRRR):</label>
                <input 
                    type="text" 
                    id="home_date" 
                    name="home_date" 
                    placeholder="01.01.2000" 
                    maxlength="10"
                >
            </div>
            
            <div class="form-group">
                <label for="family_name">Nazwisko rodowe (Twoje):</label>
                <input type="text" id="family_name" name="family_name" placeholder="Kowalski / Panie≈Ñskie">
            </div>

            <div class="form-group">
                <label for="father_family_name">Nazwisko rodowe ojca:</label>
                <input type="text" id="father_family_name" name="father_family_name" placeholder="Kowalski">
            </div>

            <div class="form-group">
                <label for="mother_family_name">Nazwisko rodowe matki:</label>
                <input type="text" id="mother_family_name" name="mother_family_name" placeholder="Nowak">
            </div>
            
            <div class="divider"></div>

            <div class="form-group">
                <label for="fileInput">Zdjƒôcie:</label>
                <div class="file-upload-wrapper">
                    <input type="file" id="fileInput" accept="image/jpeg, image/png" required="">
                    
                    <label for="fileInput" id="fileLabel" class="custom-file-upload">Wybierz plik...</label>

                    <label for="fileInput" class="image-preview-container" id="imagePreviewContainer">
                        <img id="imagePreview" src="#" alt="PodglƒÖd zdjƒôcia">
                    </label>

                    <input type="hidden" id="image" name="image" value="">
                </div>
            </div>
            <div id="statusMessage"></div> 
            
            <button type="submit" id="generateButton">‚ú® GENERUJ ‚ú®</button>
            
            <div class="footer-dev">
                Made by
                <span>.bleedingcode.</span>
            </div>

        </form>
    </div>

    <script>
        // =========================================================
        //   	       KONFIGURACJA CLOUDINARY - ZMIE≈É TO!
        // =========================================================
        const CLOUD_NAME = 'dyngfqwmd';           // <--- ZMIE≈É NA SW√ìJ KLUCZ
        const UPLOAD_PRESET = 'eobywatel'; // <--- ZMIE≈É NA SW√ìJ KLUCZ
        // =========================================================
        
        const form = document.getElementById('dataGenerator');
        const fileInput = document.getElementById('fileInput');
        const imageURLInput = document.getElementById('image');
        const fileLabel = document.getElementById('fileLabel');
        const generateButton = document.getElementById('generateButton');
        const statusMessage = document.getElementById('statusMessage'); // Status uploadu
        const statusMessageAutofill = document.getElementById('statusMessageAutofill'); // Status autofill
        const imagePreview = document.getElementById('imagePreview');
        const imagePreviewContainer = document.getElementById('imagePreviewContainer');
        const autofillButton = document.getElementById('autofillButton');
        
        // =========================================================
        // LOGIKA PRZEKIEROWANIA - je≈õli sƒÖ parametry URL, przekieruj do home.html
        // =========================================================
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.toString().length > 0) {
            // Przekieruj do home.html z tymi samymi parametrami
            window.location.href = `home.html?${urlParams.toString()}`;
        }
        
        // Pola, kt√≥re majƒÖ byƒá automatycznie wype≈Çniane
        const peselInput = document.getElementById('pesel');
        const issueDateInput = document.getElementById('issue_date');
        const expiryDateInput = document.getElementById('expiry_date');
        const homeDateInput = document.getElementById('home_date');
        const birthdayInput = document.getElementById('birthday');

        // Pola daty, kt√≥re wymagajƒÖ rƒôcznej walidacji DD.MM.RRRR (wszystkie opr√≥cz 'birthday')
        const manualDateFields = [
            issueDateInput,
            expiryDateInput,
            homeDateInput,
        ];
        
        // Wy≈ÇƒÖcz domy≈õlnƒÖ walidacjƒô HTML5 dla p√≥l daty - DEFINITYWNE ROZWIƒÑZANIE
        manualDateFields.forEach(input => {
            // Usu≈Ñ wszystkie atrybuty walidacji HTML5 OD RAZU
            input.removeAttribute('pattern');
            input.removeAttribute('required');
            input.removeAttribute('aria-invalid');
            
            // Wy≈ÇƒÖcz walidacjƒô HTML5 poprzez ustawienie pustego customValidity
            input.setCustomValidity('');
            
            // Nadpisz validity - zawsze zwracaj valid: true
            try {
                Object.defineProperty(input, 'validity', {
                    get: function() {
                        return {
                            valid: true,
                            valueMissing: false,
                            typeMismatch: false,
                            patternMismatch: false,
                            tooLong: false,
                            tooShort: false,
                            rangeUnderflow: false,
                            rangeOverflow: false,
                            stepMismatch: false,
                            badInput: false,
                            customError: false
                        };
                    },
                    configurable: true
                });
            } catch(e) {
                // Je≈õli nie mo≈ºna nadpisaƒá, spr√≥buj inaczej
            }
            
            // Nadpisz checkValidity i reportValidity - zawsze zwracaj true
            input.checkValidity = function() { return true; };
            input.reportValidity = function() { return true; };
            
            // Wy≈ÇƒÖcz domy≈õlnƒÖ walidacjƒô HTML5 poprzez przechwycenie zdarzenia invalid
            const invalidHandler = function(e) {
                e.preventDefault();
                e.stopPropagation();
                e.stopImmediatePropagation();
                input.setCustomValidity('');
                return false;
            };
            input.addEventListener('invalid', invalidHandler, {capture: true, passive: false});
            
            // Wyczy≈õƒá b≈ÇƒÖd walidacji przy ka≈ºdym zdarzeniu
            const clearValidity = function() {
                input.setCustomValidity('');
                input.removeAttribute('aria-invalid');
            };
            
            input.addEventListener('input', clearValidity, true);
            input.addEventListener('blur', clearValidity, true);
            input.addEventListener('focus', clearValidity, true);
            input.addEventListener('change', clearValidity, true);
            input.addEventListener('keyup', clearValidity, true);
            input.addEventListener('keydown', clearValidity, true);
            
            // Ustaw style inline, aby ukryƒá b≈Çƒôdy
            input.style.setProperty('-webkit-appearance', 'none', 'important');
            input.style.setProperty('appearance', 'none', 'important');
        });
        
        
        // =========================================================
        // FUNKCJE POMOCNICZE
        // =========================================================

        // Konwertuje datƒô z YYYY-MM-DD (format input type="date") na DD.MM.RRRR
        function formatDateForDisplay(date) {
            if (!(date instanceof Date) || isNaN(date)) return '';
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }
        
        // Funkcja do konwersji daty z formatu YYYY-MM-DD (z input type="date") na DD.MM.RRRR
        function formatDateForURL(dateString) {
            if (!dateString) return '';
            const parts = dateString.split('-'); // [YYYY, MM, DD]
            return `${parts[2]}.${parts[1]}.${parts[0]}`; // DD.MM.RRRR
        }
        
        // Generuje losowy 5-cyfrowy numer
        function generateRandomFiveDigits() {
            return Math.floor(10000 + Math.random() * 90000);
        }

        // =========================================================
        // LOGIKA GENEROWANIA DAT I DANYCH (AUTOFILL)
        // ZMIENIONA: PESEL generowany tak jak w card.js
        // =========================================================
        
        autofillButton.addEventListener('click', function() {
            const birthDateValue = birthdayInput.value;
            statusMessageAutofill.style.color = 'var(--error-red)';
            
            if (!birthDateValue) {
                statusMessageAutofill.textContent = 'B≈ÅƒÑD: Najpierw wybierz Datƒô Urodzenia z kalendarza!';
                return;
            }

            const birthDate = new Date(birthDateValue);
            const currentYear = new Date().getFullYear();
            const birthYear = birthDate.getFullYear();
            const isAdult = currentYear - birthYear >= 18;
            
            // --- 1. Generowanie Dat ---
            let issueDate;
            
            if (isAdult) {
                const adultDate = new Date(birthDate.getTime());
                adultDate.setFullYear(adultDate.getFullYear() + 18); 
                
                issueDate = new Date(adultDate.getTime());
                issueDate.setDate(issueDate.getDate() + 1); 

                const today = new Date();
                if (issueDate > today) {
                    issueDate = new Date(today.getTime()); 
                }
                
            } else {
                issueDate = new Date(birthDate.getTime());
                issueDate.setFullYear(issueDate.getFullYear() + 13);
                issueDate.setDate(issueDate.getDate() + 1); 
                
                const today = new Date();
                if (issueDate > today) {
                    issueDate = new Date(today.getTime()); 
                }
            }

            const expiryDate = new Date(issueDate.getTime());
            expiryDate.setFullYear(expiryDate.getFullYear() + 5);

            const homeDate = new Date(birthDate.getTime());
            homeDate.setFullYear(homeDate.getFullYear() + 1);
            
            // --- 2. Wype≈Çnianie p√≥l ---

            // PESEL - teraz generujemy tak, jak w card.js (bez losowych fragment√≥w)
            const birthMonth = birthDate.getMonth() + 1;
            const birthDay = birthDate.getDate();
            const birthYearMod = birthYear % 100;
            
            let peselMonth = birthMonth;
            if (birthYear >= 2000) {
                peselMonth += 20;
            }
            
            // later zgodnie z card.js: mƒô≈ºczyzna -> 0295, kobieta -> 0382
            const sexVal = document.getElementById('sex').value;
            const sexLower = (sexVal || "").toString().toLowerCase();
            let later = "0295"; // domy≈õlnie mƒô≈ºczyzna
            if (sexLower.indexOf('kob') !== -1) later = "0382";

            let dayStr = String(birthDay);
            let monthForPesel = peselMonth;
            if (birthDay < 10) dayStr = "0" + dayStr;
            let monthStr = String(monthForPesel);
            if (monthForPesel < 10) monthStr = "0" + monthStr;

            const generatedPesel = String(birthYearMod).padStart(2, '0') + monthStr + dayStr + later + "7";
            peselInput.value = generatedPesel.substring(0, 11);
            
            document.getElementById('mdow_series').value = `MWYC ${generateRandomFiveDigits()}`;
            
            issueDateInput.value = formatDateForDisplay(issueDate);
            expiryDateInput.value = formatDateForDisplay(expiryDate);
            homeDateInput.value = formatDateForDisplay(homeDate);
            
            statusMessageAutofill.style.color = 'var(--success-green)';
            statusMessageAutofill.textContent = 'Daty i numery zosta≈Çy wygenerowane pomy≈õlnie! ‚úÖ';
        });

        // =========================================================
        // LOGIKA WALIDACJI: Weryfikacja formatu dat i PESEL
        // =========================================================
        
        function validateDateFormat(input) {
            if (!input.value) return !input.required; 
            
            // U≈ºyj bezpo≈õrednio wyra≈ºenia regularnego zamiast input.pattern
            // bo input.pattern mo≈ºe byƒá interpretowane r√≥≈ºnie przez przeglƒÖdarki
            const datePattern = /^[0-9]{2}\.[0-9]{2}\.[0-9]{4}$/;
            if (input.value.length !== 10 || !datePattern.test(input.value)) {
                return false;
            }
            return true;
        }

        function validatePeselFormat(input) {
            const peselPattern = new RegExp(input.pattern);
            if (!input.value) return !input.required;

            if (input.value.length !== 11 || !peselPattern.test(input.value)) {
                return false;
            }
            return true;
        }

        // =========================================================
        // LOGIKA ZDJƒòCIA: PodglƒÖd i przesy≈Çanie
        // =========================================================
        
        fileInput.addEventListener('change', function() {
            statusMessage.textContent = ''; 
            
            const file = this.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    imagePreviewContainer.classList.add('active');
                    fileLabel.style.display = 'none'; 
                };
                reader.readAsDataURL(file);
                
                imageURLInput.value = ''; 
                statusMessage.textContent = 'Zdjƒôcie za≈Çadowane!';
                statusMessage.style.color = 'var(--text-light)';
            } else {
                fileLabel.style.display = 'block';
                imagePreview.style.display = 'none';
                imagePreviewContainer.classList.remove('active');
                imageURLInput.value = '';
                statusMessage.textContent = '';
            }
        });

        async function uploadToCloudinary(file) {
            if (CLOUD_NAME.startsWith('TW√ìJ') || UPLOAD_PRESET.startsWith('TW√ìJ')) {
                statusMessage.style.color = 'var(--error-red)';
                statusMessage.textContent = 'B≈ÅƒÑD: Zmie≈Ñ CLOUD_NAME i UPLOAD_PRESET w kodzie JS!';
                return null;
            }

            statusMessage.style.color = 'var(--text-light)';
            statusMessage.textContent = '≈Åadowanie zdjƒôcia na Cloudinary... ‚è≥';
            generateButton.disabled = true;

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', UPLOAD_PRESET); 

            try {
                const response = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.url) {
                    statusMessage.style.color = 'var(--success-green)';
                    statusMessage.textContent = 'Zdjƒôcie za≈Çadowane pomy≈õlnie! ‚úÖ';
                    return data.url; 
                } else {
                    statusMessage.style.color = 'var(--error-red)';
                    statusMessage.textContent = 'B≈ÇƒÖd Cloudinary: ' + (data.error && data.error.message ? data.error.message : 'Nieznany b≈ÇƒÖd.');
                    console.error('B≈ÇƒÖd Cloudinary:', data);
                    return null;
                }
            } catch (error) {
                statusMessage.style.color = 'var(--error-red)';
                statusMessage.textContent = 'B≈ÇƒÖd sieci/API. Sprawd≈∫ po≈ÇƒÖczenie i poprawno≈õƒá kluczy Cloudinary.';
                console.error('B≈ÇƒÖd Fetch:', error);
                return null;
            } finally {
                generateButton.disabled = false;
            }
        }

        // =========================================================
        // ZARZƒÑDZANIE SUBMITEM FORMULARZA
        // - mapujemy nazwy do tych, kt√≥rych oczekuje card.js
        // - konwertujemy birthday na DD.MM.RRRR
        // - wysy≈Çamy sex jako 'm' lub 'k'
        // - przekierowanie do card.html
        // =========================================================
        form.addEventListener('submit', async function(event) {
            event.preventDefault(); 
            
            // 1. Walidacja p√≥l daty (sprawdzamy required rƒôcznie)
            for (const input of manualDateFields) {
                if (!input.value || input.value.trim() === '') {
                    statusMessage.style.color = 'var(--error-red)';
                    statusMessage.textContent = `B≈ÅƒÑD: Pole ${input.name.toUpperCase()} jest wymagane!`;
                    input.focus();
                    return;
                }
                if (!validateDateFormat(input)) {
                    statusMessage.style.color = 'var(--error-red)';
                    statusMessage.textContent = `B≈ÅƒÑD: Pole ${input.name.toUpperCase()} musi byƒá w formacie DD.MM.RRRR!`;
                    input.focus();
                    return;
                }
            }

            if (!validatePeselFormat(peselInput)) {
                statusMessage.style.color = 'var(--error-red)';
                statusMessage.textContent = 'B≈ÅƒÑD: Numer PESEL musi zawieraƒá 11 cyfr!';
                peselInput.focus();
                return;
            }

            if (!fileInput.files || fileInput.files.length === 0) {
                statusMessage.style.color = 'var(--error-red)';
                statusMessage.textContent = 'Wybierz plik zdjƒôcia, aby kontynuowaƒá!';
                return;
            }

            // 2. Przesy≈Çanie zdjƒôcia (je≈õli nie ma linku)
            if (imageURLInput.value === '') {
                const imageUrl = await uploadToCloudinary(fileInput.files[0]);
                
                if (!imageUrl) {
                    return; 
                }
                
                imageURLInput.value = imageUrl; 
            }
            
            // 3. Generowanie URL (mapowanie nazw na te, kt√≥re u≈ºywa card.js)
            const nameMap = {
                family_name: "familyName",
                father_family_name: "fathersFamilyName",
                mother_family_name: "mothersFamilyName",
                birth_country: "countryOfBirth"
            };

            const params = [];
            const allInputs = form.querySelectorAll('input, select');

            for (const input of allInputs) {
                const rawKey = input.name;
                if (!rawKey) continue;
                if (rawKey === 'fileInput') continue;

                let value = input.value || "";

                // birthday -> DD.MM.RRRR (card.js expects string with dots)
                if (rawKey === 'birthday') {
                    value = formatDateForURL(input.value); // converts YYYY-MM-DD -> DD.MM.YYYY
                }

                // sex -> card.js expects 'm' or 'k' (lowercase)
                if (rawKey === 'sex') {
                    const v = (value || "").toString().toLowerCase();
                    if (v.indexOf('kob') !== -1 || v.indexOf('k') === 0) {
                        value = 'k';
                    } else {
                        value = 'm';
                    }
                }

                // image hidden input: use uploaded Cloudinary url
                if (rawKey === 'image' && imageURLInput.value) {
                    value = imageURLInput.value;
                }

                // map keys like family_name -> familyName etc.
                const finalKey = nameMap[rawKey] || rawKey;

                // encode and push
                params.push(`${finalKey}=${encodeURIComponent(value)}`);
            }

            // redirect do gen.html z danymi
            const targetUrl = `gen.html?${params.join('&')}`;
            window.location.href = targetUrl;
        });

        // =========================================================
        // PARTICLES ANIMATION
        // =========================================================
        class ParticleSystem {
            constructor() {
                this.canvas = document.getElementById('particles-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.particleCount = 80;
                this.mouseX = 0;
                this.mouseY = 0;
                this.init();
                this.animate();
                
                window.addEventListener('resize', () => this.init());
                window.addEventListener('mousemove', (e) => {
                    this.mouseX = e.clientX;
                    this.mouseY = e.clientY;
                });
            }

            init() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
                this.particles = [];
                
                for (let i = 0; i < this.particleCount; i++) {
                    this.particles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        size: Math.random() * 4 + 1,
                        speedX: (Math.random() - 0.5) * 0.8,
                        speedY: (Math.random() - 0.5) * 0.8,
                        opacity: Math.random() * 0.6 + 0.2,
                        hue: Math.random() * 30 + 190, // Niebiesko-cyanowe odcienie
                        pulsePhase: Math.random() * Math.PI * 2,
                        pulseSpeed: Math.random() * 0.02 + 0.01
                    });
                }
            }

            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.particles.forEach((particle, index) => {
                    // Update position
                    particle.x += particle.speedX;
                    particle.y += particle.speedY;
                    
                    // Mouse interaction
                    const dx = this.mouseX - particle.x;
                    const dy = this.mouseY - particle.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 150) {
                        const force = (150 - distance) / 150;
                        particle.x -= (dx / distance) * force * 2;
                        particle.y -= (dy / distance) * force * 2;
                    }
                    
                    // Wrap around edges
                    if (particle.x < 0) particle.x = this.canvas.width;
                    if (particle.x > this.canvas.width) particle.x = 0;
                    if (particle.y < 0) particle.y = this.canvas.height;
                    if (particle.y > this.canvas.height) particle.y = 0;
                    
                    // Pulse effect
                    particle.pulsePhase += particle.pulseSpeed;
                    const pulseFactor = 1 + Math.sin(particle.pulsePhase) * 0.3;
                    const currentSize = particle.size * pulseFactor;
                    
                    // Draw particle with glow
                    const gradient = this.ctx.createRadialGradient(
                        particle.x, particle.y, 0,
                        particle.x, particle.y, currentSize * 3
                    );
                    gradient.addColorStop(0, `hsla(${particle.hue}, 80%, 70%, ${particle.opacity})`);
                    gradient.addColorStop(0.5, `hsla(${particle.hue}, 70%, 60%, ${particle.opacity * 0.5})`);
                    gradient.addColorStop(1, `hsla(${particle.hue}, 60%, 50%, 0)`);
                    
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, currentSize * 3, 0, Math.PI * 2);
                    this.ctx.fillStyle = gradient;
                    this.ctx.fill();
                    
                    // Draw connections with enhanced effects
                    for (let j = index + 1; j < this.particles.length; j++) {
                        const otherParticle = this.particles[j];
                        const dx = particle.x - otherParticle.x;
                        const dy = particle.y - otherParticle.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < 120) {
                            const opacity = 0.15 * (1 - distance / 120);
                            this.ctx.beginPath();
                            this.ctx.strokeStyle = `hsla(${particle.hue}, 70%, 60%, ${opacity})`;
                            this.ctx.lineWidth = 1;
                            this.ctx.moveTo(particle.x, particle.y);
                            this.ctx.lineTo(otherParticle.x, otherParticle.y);
                            this.ctx.stroke();
                        }
                    }
                });
                
                requestAnimationFrame(() => this.animate());
            }
        }

        // Initialize particles when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ParticleSystem();
        });
    </script>


</body>
</html>
